<!DOCTYPE html>
<html>
<head>
  <title>FluxOSINT LeakGuard</title>
</head>
<body>
  <h2>LeakGuard</h2>
  <input type="password" id="pw" placeholder="Enter password">
  <button onclick="check()">Check</button>
  <pre id="out"></pre>

<script>
async function sha1(str) {
  const buf = await crypto.subtle.digest("SHA-1", new TextEncoder().encode(str));
  return [...new Uint8Array(buf)].map(b => b.toString(16).padStart(2, "0")).join("").toUpperCase();
}

async function check() {
  const pw = document.getElementById("pw").value;
  const hash = await sha1(pw);
  const prefix = hash.slice(0, 5);
  const suffix = hash.slice(5);

  const res = await fetch(`/leakguard/${prefix}`);
  const data = await res.json();

  if (data[suffix]) {
    document.getElementById("out").textContent =
      "LEAKED!! - Found " + data[suffix] + " times in breaches";
  } else {
    document.getElementById("out").textContent =
      "SAFE - Not found in known breaches";
  }
}
</script>
</body>
</html>
